from sql_helper.bao_stock_helper import BaoStockHelper
"""
select k.*,d.* from (
SELECT code,count(*) as c from bs_stock_data_day_k group by code 
) K
left join bs_stock_base_data d on d.code = k.code
order by k.c;
"""
lose_code = [
    'sh.603341',
    'sz.301165',
    'sz.301166',
    'sz.301167',
    'sz.301168',
    'sz.301169',
    'sz.301170',
    'sz.301171',
    'sz.301172',
    'sz.301175',
    'sz.301176',
    'sz.301177',
    'sz.301178',
    'sz.301179',
    'sz.301180',
    'sz.301181',
    'sz.301182',
    'sz.301183',
    'sz.301185',
    'sz.301186',
    'sz.301187',
    'sz.301188',
    'sz.301189',
    'sz.301190',
    'sz.301191',
    'sz.301192',
    'sz.301193',
    'sz.301195',
    'sz.301196',
    'sz.301197',
    'sz.301198',
    'sz.301199',
    'sz.301200',
    'sz.301201',
    'sz.301202',
    'sz.301203',
    'sz.301205',
    'sz.301206',
    'sz.301207',
    'sz.301208',
    'sz.301209',
    'sz.301210',
    'sz.301211',
    'sz.301212',
    'sz.301213',
    'sz.301215',
    'sz.301216',
    'sz.301217',
    'sz.301218',
    'sz.301219',
    'sz.301220',
    'sz.301221',
    'sz.301222',
    'sz.301223',
    'sz.301225',
    'sz.301226',
    'sz.301227',
    'sz.301228',
    'sz.301229',
    'sz.301230',
    'sz.301231',
    'sz.301232',
    'sz.301233',
    'sz.301234',
    'sz.301235',
    'sz.301236',
    'sz.301237',
    'sz.301238',
    'sz.301239',
    'sz.301246',
    'sz.301248',
    'sz.301251',
    'sz.301252',
    'sz.301255',
    'sz.301256',
    'sz.301257',
    'sz.301258',
    'sz.301259',
    'sz.301260',
    'sz.301261',
    'sz.301262',
    'sz.301263',
    'sz.301265',
    'sz.301266',
    'sz.301267',
    'sz.301268',
    'sz.301269',
    'sz.301270',
    'sz.301272',
    'sz.301273',
    'sz.301276',
    'sz.301277',
    'sz.301278',
    'sz.301279',
    'sz.301280',
    'sz.301281',
    'sz.301282',
    'sz.301283',
    'sz.301285',
    'sz.301286',
    'sz.301287',
    'sz.301288',
    'sz.301289',
    'sz.301290',
    'sz.301291',
    'sz.301292',
    'sz.301293',
    'sz.301295',
    'sz.301296',
    'sz.301297',
    'sz.301298',
    'sz.301299',
    'sz.301300',
    'sz.301301',
    'sz.301302',
    'sz.301303',
    'sz.301305',
    'sz.301306',
    'sz.301307',
    'sz.301308',
    'sz.301309',
    'sz.301310',
    'sz.301311',
    'sz.301312',
    'sz.301313',
    'sz.301314',
    'sz.301315',
    'sz.301316',
    'sz.301317',
    'sz.301318',
    'sz.301319',
    'sz.301320',
    'sz.301321',
    'sz.301322',
    'sz.301323',
    'sz.301325',
    'sz.301326',
    'sz.301327',
    'sz.301328',
    'sz.301329',
    'sz.301330',
    'sz.301331',
    'sz.301332',
    'sz.301333',
    'sz.301335',
    'sz.301336',
    'sz.301337',
    'sz.301338',
    'sz.301339',
    'sz.301345',
    'sz.301348',
    'sz.301349',
    'sz.301353',
    'sz.301355',
    'sz.301356',
    'sz.301357',
    'sz.301358',
    'sz.301359',
    'sz.301360',
    'sz.301361',
    'sz.301362',
    'sz.301363',
    'sz.301365',
    'sz.301366',
    'sz.301367',
    'sz.301368',
    'sz.301369',
    'sz.301370',
    'sz.301371',
    'sz.301372',
    'sz.301373',
    'sz.301376',
    'sz.301377',
    'sz.301378',
    'sz.301379',
    'sz.301380',
    'sz.301381',
    'sz.301382',
    'sz.301383',
    'sz.301386',
    'sz.301387',
    'sz.301388',
    'sz.301389',
    'sz.301390',
    'sz.301391',
    'sz.301393',
    'sz.301395',
    'sz.301396',
    'sz.301397',
    'sz.301398',
    'sz.301399',
    'sz.301408',
    'sz.301413',
    'sz.301418',
    'sz.301419',
    'sz.301421',
    'sz.301428',
    'sz.301429',
    'sz.301439',
    'sz.301446',
    'sz.301448',
    'sz.301456',
    'sz.301459',
    'sz.301468',
    'sz.301469',
    'sz.301486',
    'sz.301487',
    'sz.301488',
    'sz.301489',
    'sz.301498',
    'sz.301499',
    'sz.301500',
    'sz.301502',
    'sz.301503',
    'sz.301505',
    'sz.301507',
    'sz.301508',
    'sz.301509',
    'sz.301510',
    'sz.301511',
    'sz.301512',
    'sz.301515',
    'sz.301516',
    'sz.301517',
    'sz.301518',
    'sz.301519',
    'sz.301520',
    'sz.301525',
    'sz.301526',
    'sz.301528',
    'sz.301529',
    'sz.301533',
    'sz.301548',
    'sz.301550',
    'sz.301555',
    'sz.301558',
    'sz.301559',
    'sz.301566',
    'sz.301567',
    'sz.301568',
    'sz.301577',
    'sz.301578',
    'sz.301589',
    'sz.301591',
]

bsh = BaoStockHelper().conn().conn_bs()
for code in lose_code:
    bsh.sync_one_stock_k_day_to_temp(code,start_date='2014-01-01')
    bsh.del_k_data(code=code).cp_one_from_temp(code=code,start_date="2014-01-01")
bsh.clear_k_data_temp()
bsh.dis_conn().dis_conn_bs()
